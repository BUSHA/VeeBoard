<!doctype html>
<html lang="en" data-theme="light">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0" />
  <title>VeeBoard</title>

  <link rel="stylesheet" href="styles.css">

  <link rel="icon" type="image/png" href="favicon/favicon-96x96.png" sizes="96x96" />
  <link rel="icon" type="image/svg+xml" href="favicon/favicon.svg" />
  <link rel="shortcut icon" href="favicon/favicon.ico" />
  <link rel="apple-touch-icon" sizes="180x180" href="favicon/apple-touch-icon.png" />
  <meta name="apple-mobile-web-app-title" content="VeeBoard" />
  <link rel="manifest" href="favicon/site.webmanifest" />

  <script src="https://cdn.jsdelivr.net/npm/dompurify@3.0.6/dist/purify.min.js"></script>
  <script src="script.js" defer></script>

</head>

<body>
  <header class="app-header">
    <div class="toolbar" role="toolbar" aria-label="Toolbar">
      <img src="favicon/favicon-96x96.png" width="24px" alt="VeeBoard logo" class="logo" />
      <h1 class="title">VeeBoard</h1>
      <div class="toolbar-actions">
        <input id="search" class="search" type="search" placeholder="Search by title or tags…" aria-label="Search" />
        <button id="themeToggle" class="btn" title="Dark/Light theme">☼</button>
        <div class="actions">
          <div class="dropdown-menu">
            <button id="menuBtn" class="btn" title="More options">☰</button>
            <div id="menuContent" class="dropdown-content">
              <button id="addColumnBtn" class="btn" title="Add column">Add column</button>
              <button id="toggleArchiveBtn" class="btn" title="Show/Hide Archive">Show Archive</button>
              <button id="exportBtn" class="btn" title="Export JSON">Save backup</button>
              <label class="btn file-btn" title="Import JSON">Import backup<input id="importInput" type="file"
                  accept="application/json" hidden></label>
            </div>
          </div>
        </div>
      </div>
    </div>
  </header>
  <div id="tagFilters" class="tag-filters" role="group" aria-label="Tag filter"></div>

  <main id="board" class="board" aria-label="Board"></main>

  <template id="columnTemplate">
    <section class="column" role="list" aria-label="Column">
      <header class="column-header">
        <button class="drag-handle" aria-label="Drag column" title="Drag to reorder">⠿</button>
        <h2 class="column-title" tabindex="0"></h2>
        <div class="column-actions">
          <button class="btn btn-rename" title="Rename column" data-action="rename-column">✎</button>
          <button class="btn btn-del-col" title="Delete column" data-action="delete-column">✕</button>
        </div>
      </header>
      <div class="cards" role="list"></div>
      <button class="btn btn-add-card" title="Add card" data-action="add-card">+ New card</button>
    </section>
  </template>

  <template id="cardTemplate">
    <article class="card" role="listitem" tabindex="0" aria-grabbed="false" data-action="edit-card">
      <header class="card-top">
        <!-- <button class="card-grip" title="Drag card" aria-label="Drag">⠿</button> -->
        <h3 class="card-title"></h3>
        <button class="btn btn-del-card" title="Delete card" aria-label="Delete" data-action="delete-card">✕</button>
      </header>
      <p class="card-desc"></p>
      <div class="card-meta">
        <time class="card-due" title="Due"></time>
        <div class="tags"></div>
      </div>
    </article>
  </template>

  <dialog id="editor" aria-label="Edit card">
    <form id="editorForm" method="dialog" class="editor-form">
      <h3 id="editorTitle">Edit card</h3>
      <label>Title
        <input name="title" required maxlength="160" />
      </label>
      <label>Description
        <div id="descriptionEditor" class="content-editor" contenteditable="true" role="textbox"></div>
      </label>
      <div class="hotkey-hints">
        <span><kbd>Cmd/Ctrl</kbd> + <kbd>B</kbd> - bold,</span>
        <span><kbd>Cmd/Ctrl</kbd> + <kbd>I</kbd> - italic,</span>
        <span><kbd>Cmd/Ctrl</kbd> + <kbd>V</kbd> - add link,</span>
        <span><kbd>Cmd/Ctrl</kbd> + <kbd>K</kbd> - remove link</span>
      </div>
      <div class="editor-form-row">
        <label style="flex:2">Tags (comma-separated)
          <input name="tags" placeholder="ui, bug, research" />
        </label>
        <label style="flex:1">Due date
          <input name="due" type="datetime-local" />
        </label>
      </div>
      <label class="toggle-switch">
        <p id="notification-permission-warning" class="notification-warning hidden"></p>
        <input name="reminderEnabled" type="checkbox" />
        <span class="slider"></span>
        <span class="label-text">Set a reminder</span>
        <div>
          <select name="reminderOffset" class="hidden"
            style="padding: 8px; border-radius: 8px; border: 1px solid var(--border);">
            <option value="1">1m</option>
            <option value="5">5m</option>
            <option value="15">15m</option>
            <option value="30" selected>30m</option>
            <option value="60">1h</option>
          </select>
          <span id="afterLabel" style="margin-left: 10px;" class="label-text hidden"> before the due date</span>

        </div>
      </label>
      <div class="editor-actions">
        <button type="button" value="cancel" class="btn secondary" formnovalidate>Cancel</button>
        <button value="default" class="btn primary">Save</button>
      </div>
    </form>
  </dialog>

  <dialog id="colDialog" aria-label="Create column">
    <form id="colForm" method="dialog" class="editor-form">
      <h3>Create column</h3>
      <label>Name
        <input name="title" required maxlength="120" />
      </label>
      <div class="editor-actions">
        <button type="button" value="cancel" class="btn secondary" formnovalidate>Cancel</button>
        <button value="default" class="btn primary">Create</button>
      </div>
    </form>
  </dialog>

  <dialog id="renameDialog" aria-label="Rename column">
    <form id="renameForm" method="dialog" class="editor-form">
      <h3>Column settings</h3>
      <label>Title
        <input name="title" required maxlength="160" />
      </label>
      <div class="checkbox-wrapper">
        <label class="toggle-switch">
          <input name="isDoneColumn" type="checkbox" />
          <span class="slider"></span>
          <span class="label-text">Mark as column for completed cards</span>
        </label>
      </div>
      <div class="editor-actions">
        <button type="button" value="cancel" class="btn secondary" formnovalidate>Cancel</button>
        <button value="default" class="btn primary">Save</button>
      </div>
    </form>
  </dialog>

  <dialog id="confirmDialog" aria-label="Confirm action">
    <form id="confirmForm" method="dialog" class="editor-form">
      <h3 id="confirmTitle">Delete card?</h3>
      <p id="confirmText" style="margin:4px 0 0"></p>
      <div class="editor-actions" style="grid-template-columns: 1fr 1fr 1fr;">
        <button type="button" value="cancel" class="btn secondary" formnovalidate>Cancel</button>
        <button id="confirmOk" value="delete" class="btn error">Delete</button>
        <button value="archive" class="btn primary">Archive</button>
      </div>
    </form>
  </dialog>

  <dialog id="importChoice" aria-label="Import options">
    <form id="importChoiceForm" method="dialog" class="editor-form">
      <h3>Import options</h3>
      <p>How to apply the imported JSON?</p>
      <div class="editor-actions" style="grid-template-columns: 1fr 1fr 1fr;">
        <button type="button" value="cancel" class="btn secondary">Cancel</button>
        <button class="btn" value="replace">Replace</button>
        <button class="btn primary" value="merge">Merge</button>
      </div>
    </form>
  </dialog>

</body>

</html>